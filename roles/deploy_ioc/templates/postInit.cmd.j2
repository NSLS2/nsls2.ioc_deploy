
cd $(TOP)/{{ deploy_ioc_as_dir_name }}/req

{% if deploy_ioc_make_autosave_files %}
makeAutosaveFiles()
create_monitor_set("info_settings.req", 30, "")
create_monitor_set("info_positions.req", 10, "")

set_pass0_restoreFile("info_positions.sav")
set_pass0_restoreFile("info_settings.sav")
set_pass1_restoreFile("info_settings.sav")

{% endif %}
{% for reqfile in deploy_ioc_req_file_list %}
create_monitor_set("{{ reqfile.name }}", 30, "{{ reqfile.macros }}")
set_pass0_restoreFile("{{ reqfile.name | replace('.req', '.sav') }}")
{% endfor %}

{% if deploy_ioc_merged_env.CT_PREFIX is defined %}
save_restoreSet_status_prefix("$(CT_PREFIX)")
{% elif deploy_ioc_merged_env.IOC_PREFIX is defined %}
save_restoreSet_status_prefix("$(IOC_PREFIX)")
{% elif deploy_ioc_merged_env.PREFIX is defined %}
save_restoreSet_status_prefix("$(PREFIX)")
{% endif %}


{% for dbpf in deploy_ioc_dbpf_list %}
dbpf "{{ dbpf.pv }}", "{{ dbpf.value }}"
{% if dbpf.sleep is defined %}
epicsThreadSleep({{ dbpf.sleep }})
{% endif %}
{% endfor %}

cd $(TOP)
